(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{"30d6":function(t,n,e){"use strict";e.r(n);var o=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("q-page",{staticClass:"fit column content-center wrap",attrs:{padding:""}},[e("q-table",{staticStyle:{width:"90%"},attrs:{grid:t.$q.screen.xs,title:"收藏",data:t.data,columns:t.columns,"row-key":"name",filter:t.filter,separator:"cell",selection:t.selection,selected:t.selected,pagination:t.initialPagination,"visible-columns":t.visibleColumns,flat:""},on:{"update:selected":function(n){t.selected=n}},scopedSlots:t._u([{key:"top",fn:function(){return[t.me?e("q-btn",{attrs:{color:"primary",label:"批量关注",unelevated:""},on:{click:t.doAdd}}):t._e(),t.me?e("q-btn",{staticClass:"q-ml-sm",attrs:{color:"negative",label:"批量取消关注",unelevated:""},on:{click:t.doRemove}}):t._e(),e("q-space"),e("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"搜索关注列表"},scopedSlots:t._u([{key:"append",fn:function(){return[e("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.filter,callback:function(n){t.filter=n},expression:"filter"}})]},proxy:!0},{key:"body-cell-名字",fn:function(n){return[e("q-td",{attrs:{props:n}},[e("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.toExpert(n.row.id)}}},[t._v(t._s(n.row.name))])])]}},{key:"body-cell-关注",fn:function(n){return[e("q-td",{attrs:{props:n}},[e("q-icon",{staticStyle:{cursor:"pointer"},attrs:{name:n.row.icon,size:"large"},on:{click:function(e){return t.changeFollow(n.row)}}})],1)]}}])})],1)},i=[],a=(e("4160"),e("b0c0"),e("159b"),e("4ec3")),l={name:"Collection",data:function(){return{filter:"",selected:[],initialPagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:10},columns:[{name:"名字",required:!0,label:"学者",align:"center",field:function(t){return t.name},sortable:!0},{name:"所属机构",label:"所属机构",field:"org",align:"center"},{name:"成果数",label:"成果数",field:"n_pubs",align:"center",sortable:!0},{name:"被引量",label:"被引量",field:"n_citation",align:"center",sortable:!0},{name:"关注",label:"关注",field:"icon",align:"center"}],data:[]}},computed:{visibleColumns:function(){return this.me?["名字","所属机构","成果数","被引量","关注"]:["名字","所属机构","成果数","被引量"]},me:function(){return this.$route.params.uId+""===localStorage.getItem("userId")+""},selection:function(){return this.me?"multiple":"none"}},mounted:function(){this.init()},methods:{init:function(){var t=this;Object(a["n"])(this.$route.params.uId).then((function(n){200===n.status&&(n.data.data.forEach((function(n){var e=n;e.icon="o_visibility_off",t.data.push(e)})),t.initialPagination.rowsNumber=t.data.length,console.log(t.initialPagination.rowsNumber))})).catch((function(t){console.log(t)}))},doAdd:function(){var t=this;this.selected.forEach((function(n){t.doFollow(n,(function(t){t&&(n.icon="o_visibility_off")}))})),this.selected=[]},doRemove:function(){var t=this;this.selected.forEach((function(n){t.undoFollow(n,(function(t){t&&(n.icon="o_visibility")}))})),this.selected=[]},changeFollow:function(t){var n=this;this.data.forEach((function(e){e.id===t.id&&("o_visibility_off"===e.icon?(console.log("取关"),n.undoFollow(e,(function(t){t&&(e.icon="o_visibility",console.log(n.data,e,e.icon))}))):(console.log("关注"),n.doFollow(e,(function(t){t&&(e.icon="o_visibility_off",console.log(n.data,e,e.icon))}))))}))},toExpert:function(t){this.$router.push({name:"expMain",params:{expId:t}})},doFollow:function(t,n){Object(a["h"])(t.id).then((function(t){200===t.status?n(!0):n(!1)})).catch((function(t){console.log(t),n(!1)}))},undoFollow:function(t,n){Object(a["x"])(t.id).then((function(t){200===t.status?n(!0):n(!1)})).catch((function(t){console.log(t),n(!1)}))}}},c=l,s=e("c701"),r=e("9989"),u=e("eaac"),d=e("9c40"),f=e("2c91"),p=e("27f9"),m=e("0016"),b=e("db86"),h=e("3117"),g=e.n(h),w=Object(s["a"])(c,o,i,!1,null,null,null);n["default"]=w.exports;g()(w,"components",{QPage:r["a"],QTable:u["a"],QBtn:d["a"],QSpace:f["a"],QInput:p["a"],QIcon:m["a"],QTd:b["a"]})}}]);